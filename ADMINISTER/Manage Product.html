<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Manage Product</title>
  <link rel="stylesheet" href="Sidebar.css">
  <link rel="stylesheet" href="Admin.css">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
  <link rel="stylesheet" href="Manage Product.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0-2/css/all.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
</head>

<body onload="render()">
  <header>
    <div class="sidebar-content fixed-top">
        <input type="checkbox" id="checkbox">
        <label for="checkbox">
            <i class="fas fa-bars" id="open"></i>
            <i class="fas fa-times" id="close"></i>
        </label>
        <div class="sidebar">
            <ul>
            <li>
                <a href="Admin Profile.html"><ion-icon name="person-circle"></ion-icon> Account</a>
            </li>
            <li>
                <a href="Manage Product.html"><ion-icon name="pie-chart"></ion-icon>  Manage</a>
            </li>
            <li>
                <a href="Revenue Statistics.html"><ion-icon name="bar-chart"></ion-icon> Business</a>
            </li>
            <li>
                <a href="đăng nhập.html"><ion-icon name="log-out-outline"></ion-icon> Log out</a>
            </li>
            </ul>
        </div>
  </div>
    <nav class="navbar fixed-top">
        <div class="row container">
            <div class="col-4"></div>
            <div class="col-6">
               <h2 class="nav-item">Quan ly he thong</h2> 
            </div>
            <div class="col-2"></div>
        </div>
    </nav>
  </header>
  <section class="content">
    <div class="container">
        <div class="row">
            <div class="col-4 product-content">
                <a href="#">Quản lý sản phẩm</a>
            </div>
            <div class="col-4 customer-content">
                <a href="Manage Customer.html">Quản lý khách hàng</a>
            </div>
            <div class="col-4 order-content">
                <a href="Manage Order.html">Quản lý đơn hàng</a>
            </div>
        </div>
        <div class="content-manage">
            <div class="form">
                <div class="form-group">
                    <label for="name_product">Tên sản phẩm: </label>
                    <input type="text" id="name_product" class="form-input">
                    <div class="error-message"></div>
                </div>
                <div class="form-group">
                    <label for="money">Giá sản phẩm: </label>
                    <input type="text" id="money" class="form-input">
                    <div class="error-message"></div>
                </div>
                <div class="form-group">
                    <label for="">Tải hình ảnh: </label>
                    <img src="" alt="" id="image" width="200" height="200">
                    <input class="image" type="file" name="" id="imageFile" onchange="chooseFile(this)"
                    accept="image/gif , image/jpeg , image/png" required>
                </div>
                <div class="form-group">
                    <input type="hidden" id="index">
                </div>
                <div>
                    <button id="save" onclick="add()">Submit</button>
                    <button id="update" style="display: none;" onclick="changeInfo()">Update</button>
                </div>
            </div>

            <table class="table" id="table">
                <thead>
                    <tr>
                        <th>Tên</th>
                        <th>Money</th>
                        <th>Image</th>
                        <th>Actions</th>
                    </tr>
                </thead>
            </table>
        </div>
    </div>
  </section>

    <script>
        function resetInput(){
            document.getElementById("name_product").value =""
            document.getElementById("money").value = ""
            document.getElementById("imageFile").value = ""
        }

        function chooseFile(fileInput){
            if (fileInput.files && fileInput.files[0]){
                var reader = new FileReader();
                
                reader.onload = function (e) {
                    $('#image').attr('src', e.target.result);
                }
                reader.readAsDataURL(fileInput.files[0]);
            }
        }

        function validataInput(){
            let formElement = document.querySelector(".form")
            let inputElement = formElement.querySelectorAll(".form-input")
            
            for(let i=0 ; i<inputElement.length ; i++){
                if(inputElement[i].value === ""){
                    inputElement[i].parentElement.querySelector(".error-message").innerText = `Please enter your ${inputElement[i].id}`
                }
                else{
                    inputElement[i].parentElement.querySelector(".error-message").innerText = ""
                }
            }
        }

        function add(){
            validataInput()
            let formElement = document.querySelector(".form")
            let errorElement = formElement.querySelectorAll(".error-message")
            let arrErrorElement = []
            for (let i=0 ; i<errorElement.length ; i++){
                arrErrorElement.push(errorElement[i].innerText)
            }
            let checkErrorElement = arrErrorElement.every(value => value === "")
            if (checkErrorElement){
                let name = document.getElementById("name_product").value
                let money = document.getElementById("money").value
                let image = document.getElementById("imageFile").value
                let listInfo = localStorage.getItem("list-info") ? JSON.parse(localStorage.getItem("list-info")) : []
                listInfo.push({
                    name: name,
                    money: money,
                    image: image
                })
                localStorage.setItem("list-info",JSON.stringify(listInfo))
                render()
                resetInput()
            }
        }

        function render(){
            let listInfo = localStorage.getItem("list-info") ? JSON.parse(localStorage.getItem("list-info")) : []
            let table = `<tr>
                        <th>Tên</th>
                        <th>Money</th>
                        <th>Image</th>
                        <th>Actions</th>
                    </tr>`

            listInfo.map((value,index)=>{
                table += `<tr>
                        <td>${value.name}</td>
                        <td>${value.money}</td>
                        <td>${value.image}</td>
                        <td>
                            <button onclick="edit(${index})">Edit</button>
                            <button onclick="deleteItem(${index})">Delete</button>
                        </td>
                    </tr>`
            })

            document.getElementById("table").innerHTML = table
        }

        function edit(index){
            let listInfo = localStorage.getItem("list-info") ? JSON.parse(localStorage.getItem("list-info")) : []
            document.getElementById("name_product").value = listInfo[index].name
            document.getElementById("money").value = listInfo[index].money
            document.getElementById("index").value = index

            document.getElementById("save").style.display = "none"
            document.getElementById("update").style.display = "inline-block"
        }

        function changeInfo(){
            let listInfo = localStorage.getItem("list-info") ? JSON.parse(localStorage.getItem("list-info")) : []
            let index = document.getElementById("index").value
            listInfo[index]={
                name: document.getElementById("name_product").value,
                money: document.getElementById("money").value,
                image: document.getElementById("imageFile").value
            }
            localStorage.setItem("list-info", JSON.stringify(listInfo))
            render()
        }
        
        function deleteItem(index) {
            let listInfo = localStorage.getItem("list-info") ? JSON.parse(localStorage.getItem("list-info")) : []
            if(confirm("Are you Sure?")){
                listInfo.splice(index,1)
            }
            localStorage.setItem("list-info", JSON.stringify(listInfo))            
            document.getElementById("update").style.display = "none"
            document.getElementById("save").style.display = "inline-block"
            render()
            resetInput()
        }
    </script>


    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>
</body>

</html>